{% extends 'carbono/base.html' %}
{% load static %}
{% block content %}
<div class='center'>
  <h1>Calculadora de Carbono</h1>

  <div class="container">
    <h2>Cálculo para Carro</h2>
    <form method="post">
      {% csrf_token %}
      <div class="form-group">
        <label for="carro_tipo">Tipo de Carro:</label>
        <select id="carro_tipo" name="carro_tipo" class="form-control">
          <option value="">Selecione o tipo de carro</option>
          {% for carro in carros %}
          <option value="{{ carro.tipo }}">{{ carro.tipo }}</option>
          {% endfor %}
        </select>
      </div>

      <div class="form-group">
        <label for="km_por_mes">Km por mês:</label>
        <input type="number" id="km_por_mes" name="km_por_mes" class="form-control" required>
      </div>

      <button type="submit" class="btn btn-primary">Calcular</button>
    </form>

    {% if carro_resultado %}
        <p><b>Resultado:</b></p>
        <p>Crédito de Carbono Mensal: {{ carro_resultado.credito }} tco<sub>2</sub></p>
        <p>Crédito de Carbono Anual: {{ carro_resultado.anual }} tco<sub>2</sub></p>
    {% endif %}
  </div>

  <div class="container">
    <h2>Cálculo para Energia</h2>
    <form method="post">
      {% csrf_token %}
      <div class="form-group">
        <label for="energia_tipo">Tipo de Energia:</label>
        <div id="energia_tipo">
          {% for energia in energias %}
            <div>
              <input type="radio" id="energia_{{ forloop.counter }}" name="energia_tipo" value="{{ energia.modo_de_calculo }}" class="form-check-input">
              <label for="energia_{{ forloop.counter }}" class="form-check-label">{{ energia.legenda }}</label>
            </div>
          {% endfor %}
        </div>
      </div>

      <div id="kwh_input" style="display: none;">
        <div class="form-group">
          <label for="kwh_usado">kWh Usado:</label>
          <input type="number" id="kwh_usado" name="kwh_usado" class="form-control" required>
        </div>
      </div>

      <div id="conta_input" style="display: none;">
        <div class="form-group">
          <label for="valor_da_conta">Valor da Conta de Luz:</label>
          <input type="number" id="valor_da_conta" name="valor_da_conta" class="form-control" required>
        </div>
      </div>

      <button type="submit" class="btn btn-primary">Calcular</button>
    </form>

    {% if energia_resultado %}
      <p>Crédito de Carbono Mensal: {{ energia_resultado.credito }} tco<sub>2</sub></p>
      <p>Crédito de Carbono Anual: {{ energia_resultado.anual }} tco<sub>2</sub></p>
    {% endif %}
  </div>

  */ Aqui pode colocar divs com o cálculo de Ônibus, semelhante ao Carros,
  Não precisa inserir código Django ainda, pode colocar o HTML puro

  Também inserir as divs para Gás, semelhante ao energia,
  Pode usar também o JavaScript com lógica para as opções*/

  {% if total_anual %}
  <div class="container">
    <h2>Resultado Total</h2>
    <p>Total Anual: {{ total_anual }} toneladas</p>
    <p>Árvores necessárias: {{ arvores_necessarias }} árvores</p>
    <p>Valor da tonelada: R$ {{ valor_tonelada }}</p>
  </div>
  {% endif %}

  <div class="container">
    <form method="post" action="{% url 'limpar_sessao' %}">
      {% csrf_token %}
      <button type="submit" class="btn btn-danger">Limpar Resultados</button>
    </form>
  </div>
</div>

<style>
  .center {
    margin: auto;
    width: 60%;
    border: 3px solid #a5addb;
    padding: 10px;
  }
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // JavaScript para controlar visibilidade dos inputs
  const energiaTipoRadios = document.querySelectorAll('input[name="energia_tipo"]');
  const kwhInput = document.getElementById('kwh_input');
  const contaInput = document.getElementById('conta_input');
  const kwhInputField = document.getElementById('kwh_usado');  // campo de kWh
  const contaInputField = document.getElementById('valor_da_conta');  // campo de valor da conta

  energiaTipoRadios.forEach((radio) => {
    radio.addEventListener('change', () => {
      console.log(`Radio button changed: ${radio.value}`);
      if (radio.value === 'Kwh') {
        kwhInput.style.display = 'block';  // Mostra campo de kWh
        contaInput.style.display = 'none';  // Esconde campo de valor da conta
        kwhInputField.disabled = false;  // Habilita input de kWh
        contaInputField.disabled = true;  // Desabilita input de valor da conta
      } else if (radio.value === 'Conta de Luz') {
        kwhInput.style.display = 'none';  // Esconde campo de kWh
        contaInput.style.display = 'block';  // Mostra campo de valor da conta
        kwhInputField.disabled = true;  // Desabilita input de kWh
        contaInputField.disabled = false;  // Habilita input de valor da conta
      } else {
        kwhInput.style.display = 'none';  // Esconde ambos os campos
        contaInput.style.display = 'none';
        kwhInputField.disabled = true;  // Desabilita ambos os campos
        contaInputField.disabled = true;
      }
    });
  });
});
</script>

{% endblock %}
